
CREATE TABLE PELICULA(ID_PELICULA INTEGER, TITULO VARCHAR2(120), DIRECTOR VARCHAR2(120), SINOPSIS VARCHAR2(255),CONSTRAINT PK_ID_PELICULA PRIMARY KEY(ID_PELICULA)); 


CREATE TABLE HORARIO(ID_HORARIO INTEGER, ID_PELICULA INTEGER,FECHA DATE, CONSTRAINT PK_ID_HORARIO PRIMARY KEY(ID_HORARIO), CONSTRAINT FK1_ID_PELICULA FOREIGN  KEY(ID_PELICULA) REFERENCES PELICULA (ID_PELICULA));


CREATE TABLE SALA(ID_SALA INTEGER, ID_PELICULA INTEGER, ID_HORARIO INTEGER, NUM_ASIENTO INTEGER, CONSTRAINT PK_ID_SALA PRIMARY KEY (ID_SALA),CONSTRAINT FK1_ID_PELICULA FOREIGN KEY(ID_PELICULA) REFERENCES PELICULA (ID_PELICULA), CONSTRAINT FK2_ID_HORARIO FOREIGN KEY(ID_HORARIO) REFERENCES HORARIO(ID_HORARIO)); 

CREATE TABLE REPARTO(ID_REPARTO INTEGER, ID_PELICULA INTEGER, NOMBRE VARCHAR2(100),APELLIDO VARCHAR2(100),CONSTRAINT PK_ID_REPARTO PRIMARY KEY (ID_REPARTO), CONSTRAINT FK1_ID_PELICULA FOREIGN KEY (ID_PELICULA) REFERENCES PELICULA (ID_PELICULA));


/* GENERAMOS LA SECUENCIA CORRESPONDIENTE A LA TABLA PELICULA*/

CREATE SEQUENCE SECUENCIA_PELICULA
START WITH 1
INCREMENT BY 1
NOMAXVALUE;

CREATE SEQUENCE SECUENCIA_HORARIO
START WITH 1
INCREMENT BY 1
NOMAXVALUE;

CREATE SEQUENCE SECUENCIA_SALA
START WITH 1
INCREMENT BY 1
NOMAXVALUE;

CREATE SEQUENCE SECUENCIA_REPARTO
START WITH 1
INCREMENT BY 1
NOMAXVALUE;


CREATE OR REPLACE PROCEDURE GUARDAR_PELICULA(MY_ID_PELICULA OUT INTEGER, MY_TITULO IN VARCHAR2, MY_DIRECTOR IN VARCHAR2, MY_SINOPSIS VARCHAR2, )
AS 
BEGIN
SELECT SECUENCIA_PELICULA.NEXTVAL INTO MY_ID_PELICULA
FROM DUAL;
INSERT INTO PELICULA VALUES(MY_ID_PELICULA,MY_TITULO,MY_DIRECTOR,MY_SINOPSIS);
END;
/

DECLARE
VALOR INTEGER;
BEGIN
GUARDAR_PELICULA(VALOR,’HERCULES’,’PEDRITO’,’EL DIOS MAS FUERTE DEL MUNDO BLA BLA’);
DBMS_OUTPUT.PUT_LINE(‘REGISTRO GUARDADO CON ID:||VALOR);
END;
/


CREATE OR REPLACE PROCEDURE GUARDAR_HORARIO(MY_ID_HORARIO OUT INTEGER, MY_FECHA DATE )
AS 
BEGIN
SELECT SECUENCIA_HORARIO.NEXTVAL INTO MY_ID_HORARIO
FROM DUAL;
INSERT INTO HORARIO VALUES(MY_ID_HORARIO,MY_FECHA);
END;
/

DECLARE
VALOR INTEGER;
BEGIN
GUARDAR_HORARIO(VALOR,10/03/14);
DBMS_OUTPUT.PUT_LINE(‘REGISTRO GUARDADO CON ID:||VALOR);
END;
/

CREATE OR REPLACE PROCEDURE GUARDAR_SALA(MY_ID_SALA OUT INTEGER, MY_NUM_ASIENTO IN INTEGER)
AS 
BEGIN
SELECT SECUENCIA_SALA.NEXTVAL INTO MY_ID_SALA
FROM DUAL;
INSERT INTO SALA VALUES(MY_ID_SALA,MY_NUM_ASIENTO);
END;
/

DECLARE
VALOR INTEGER;
BEGIN
GUARDAR_SALA(VALOR,10);
DBMS_OUTPUT.PUT_LINE(‘REGISTRO GUARDADO CON ID:||VALOR);
END;
/

CREATE OR REPLACE PROCEDURE GUARDAR_REPARTO(MY_ID_REPARTO OUT INTEGER, MY_NOMBRE IN VARCHAR2, MY_APELLIDO IN VARCHAR2 )
AS 
BEGIN
SELECT SECUENCIA_REPARTO.NEXTVAL INTO MY_ID_REPARTO
FROM DUAL;
INSERT INTO REPARTO VALUES(MY_ID_REPARTO,MY_NOMBRE,MY_APELLIDO);
END;
/

DECLARE
VALOR INTEGER;
BEGIN
GUARDAR_REPARTO(VALOR,’CARMEN’,’SALINAS’);
DBMS_OUTPUT.PUT_LINE(‘REGISTRO GUARDADO CON ID:||VALOR);
END;
/
